```bash
 az aks get-credentials  --resource-group packamal-rg --name packamal-aks
 ```

Merged "packamal-aks" as current context in /root/.kube/config

```bash
azureuser in ğŸŒ dev in packamal on î‚  k8s [?] 
â¯ k get nodes
NAME                                STATUS   ROLES    AGE   VERSION
aks-agentpool-38156302-vmss000000   Ready    <none>   18h   v1.33.5

azureuser in ğŸŒ dev in packamal on î‚  k8s [?] took 2s 
â¯ k get services
NAME         TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE
kubernetes   ClusterIP   10.0.0.1     <none>        443/TCP   18h
```




```sh
â¯ k describe node aks-agentpool-38156302-vmss000000
```


## Create registry to push image

```sh
azureuser in ğŸŒ dev in packamal on î‚  k8s [?] 
â¯ az provider register --namespace Microsoft.ContainerRegistry
Registering is still on-going. You can monitor using 'az provider show -n Microsoft.ContainerRegistry'

azureuser in ğŸŒ dev in packamal on î‚  k8s [?] 
â¯ az provider register --namespace Microsoft.ContainerService

azureuser in ğŸŒ dev in packamal on î‚  k8s [?] 
â¯ az provider register --namespace Microsoft.Compute

azureuser in ğŸŒ dev in packamal on î‚  k8s [?] took 2s 
â¯ az provider register --namespace Microsoft.Network

azureuser in ğŸŒ dev in packamal on î‚  k8s [?] took 3s 
â¯ az acr create --resource-group packamal-rg --name packamalacr --sku Basic
{
  "adminUserEnabled": false,
  "anonymousPullEnabled": false,
  "autoGeneratedDomainNameLabelScope": "Unsecure",
  "creationDate": "2026-01-02T03:58:10.264381+00:00",
  "dataEndpointEnabled": false,
  "dataEndpointHostNames": [],
  "encryption": {
    "keyVaultProperties": null,
    "status": "disabled"
  },
  "id": "/subscriptions/7e995f87-1e7a-4a5f-bf12-25f435a84be0/resourceGroups/packamal-rg/providers/Microsoft.ContainerRegistry/registries/packamalacr",
  "identity": null,
  "location": "eastasia",
  "loginServer": "packamalacr.azurecr.io",
  "metadataSearch": "Disabled",
  "name": "packamalacr",
  "networkRuleBypassOptions": "AzureServices",
  "networkRuleSet": null,
  "policies": {
    "azureAdAuthenticationAsArmPolicy": {
      "status": "enabled"
    },
    "exportPolicy": {
      "status": "enabled"
    },
    "quarantinePolicy": {
      "status": "disabled"
    },
    "retentionPolicy": {
      "days": 7,
      "lastUpdatedTime": "2026-01-02T03:58:18.419702+00:00",
      "status": "disabled"
    },
    "softDeletePolicy": {
      "lastUpdatedTime": "2026-01-02T03:58:18.419752+00:00",
      "retentionDays": 7,
      "status": "disabled"
    },
    "trustPolicy": {
      "status": "disabled",
      "type": "Notary"
    }
  },
  "privateEndpointConnections": [],
  "provisioningState": "Succeeded",
  "publicNetworkAccess": "Enabled",
  "resourceGroup": "packamal-rg",
  "roleAssignmentMode": "LegacyRegistryPermissions",
  "sku": {
    "name": "Basic",
    "tier": "Basic"
  },
  "status": null,
  "systemData": {
    "createdAt": "2026-01-02T03:58:10.264381+00:00",
    "createdBy": "packguard.dev@gmail.com",
    "createdByType": "User",
    "lastModifiedAt": "2026-01-02T03:58:10.264381+00:00",
    "lastModifiedBy": "packguard.dev@gmail.com",
    "lastModifiedByType": "User"
  },
  "tags": {},
  "type": "Microsoft.ContainerRegistry/registries",
  "zoneRedundancy": "Disabled"
}

azureuser in ğŸŒ dev in packamal on î‚  k8s [?] took 11s 
â¯ 
```

Then login
```sh
azureuser in ğŸŒ dev in packamal on î‚  k8s [?] took 2s 
â¯ az acr login --name packamalacr
Login Succeeded

```

Check:

```sh
az acr list \
  --resource-group packamal-rg \
  --query "[].{acrLoginServer:loginServer}" \
  --output table
```

Login

```sh
az acr login --name packamalacr
```

```packamalacr.azurecr.io``` is registry of our setup

Then tag and push images to registry
```sh
azureuser in ğŸŒ dev in packamal on î‚  k8s [?] 
â¯ docker tag packamal-backend:local packamalacr.azurecr.io/packamal-backend:latest

azureuser in ğŸŒ dev in packamal on î‚  k8s [?] 
â¯ docker push packamalacr.azurecr.io/packamal-backend:latest
```

```sh
azureuser in ğŸŒ dev in packamal on î‚  k8s [?] 
â¯ docker tag packamal-frontend:local packamalacr.azurecr.io/packamal-frontend:latest

azureuser in ğŸŒ dev in packamal on î‚  k8s [?] 
â¯ docker push packamalacr.azurecr.io/packamal-frontend:latest
The push refers to repository [packamalacr.azurecr.io/packamal-frontend]
```

```sh
docker tag packamal-go-worker-analysis:local  packamalacr.azurecr.io/packamal-go-worker-analysis:latest

docker push  packamalacr.azurecr.io/packamal-go-worker-analysis:latest

```


Intergrating ACR to AKS

```sh
az aks update -n packamal-aks -g packamal-rg --attach-acr packamalacr
```
Explain arguments command:
`-n packamal-aks`: (Short for --name) Specifies the name of the AKS cluster.
`-g packamal-rg`: (Short for --resource-group) Specifies the resource group where the cluster is located.
`--attach-acr packamalacr` : Establishes a connection between the AKS cluster and the Container Registry named sbdemo01.


# access to fronend server 
```sh
kubectl get svc -n packamal frontend
```

# access to frontend

Example IP: `20.187.145.56`

```bash
curl -X POST "http://135.233.163.34/api/v1/analyze/" \
  -H "Authorization: Bearer kJOoulCIV11wdUVpDWtgk0Y44llyEFAng7a32Cpnj8taeae5vNkOimpRZyEd8hWk" \
  -H "Content-Type: application/json" \
  -d '{"purl": "pkg:npm/lodash@4.17.21"}'
```